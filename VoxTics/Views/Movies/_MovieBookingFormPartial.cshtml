@model VoxTics.Models.ViewModels.MovieBookingVM

<form asp-action="ConfirmBooking" method="post" id="bookingForm">
    <input type="hidden" asp-for="MovieId" />
    <input type="hidden" asp-for="MovieTitle" />

    <div class="mb-3">
        <label asp-for="CustomerName" class="form-label"></label>
        <input asp-for="CustomerName" class="form-control" required />
        <span asp-validation-for="CustomerName" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label asp-for="Seats" class="form-label"></label>
        <input asp-for="Seats" type="number" class="form-control" min="1" max="10" required />
        <span asp-validation-for="Seats" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-success w-100">
        <i class="bi bi-ticket-perforated"></i> Confirm Booking
    </button>
</form>

<script>
    document.getElementById("bookingForm").addEventListener("submit", function (e) {
        e.preventDefault();
        let form = this;

        fetch(form.action, {
            method: "POST",
            body: new FormData(form),
            headers: { "X-Requested-With": "XMLHttpRequest" }
        })
        .then(res => res.json())
        .then(data => {
            if (data.success) {
                const modal = bootstrap.Modal.getInstance(document.getElementById("bookingModal"));
                modal.hide();
                alert(data.message);
            }
        });
    });
</script>
