@model VoxTics.Areas.Admin.ViewModels.Movie.MovieListItemViewModel
@using VoxTics.Models.Enums
@inject VoxTics.Helpers.ImgsHelper.ImageManager ImgManager

@{
    // Resolve image URL (prefer absolute if provided, otherwise use ImgManager)
    string imgUrl;
    if (!string.IsNullOrWhiteSpace(Model.MainImageUrl))
    {
        imgUrl = Uri.IsWellFormedUriString(Model.MainImageUrl, UriKind.Absolute)
            ? Model.MainImageUrl
            : ImgManager.GetImageWebPath(ImageType.Movie, Model.Slug, Model.MainImageUrl);
    }
    else
    {
        imgUrl = ImgManager.GetImageWebPath(ImageType.Movie, Model.Slug, null);
    }
}

<tr>
    <td>
        <img src="@imgUrl"
             alt="@Model.Title"
             width="60"
             onerror="this.onerror=null;this.src='@Url.Content("~/images/defaults/placeholder.png")';" />
    </td>
    <td>@Model.Title</td>
    <td>@Model.CategoryName</td>
    <td>@Model.ShowtimeCount</td>
    <td>@Model.Price.ToString("C")</td>
    <td>@Model.Status</td>
    <td>
        <a asp-action="Details" asp-route-id="@Model.Id" class="btn btn-sm btn-primary">Details</a>
        <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-sm btn-warning">Edit</a>
        <a asp-action="Delete" asp-route-id="@Model.Id" class="btn btn-sm btn-danger">Delete</a>
    </td>
</tr>
